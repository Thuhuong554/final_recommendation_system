<button 
    onclick="toggleBookmark({{ destination.id }}, this)"
    class="absolute top-4 right-4 p-2 bg-white rounded-full shadow-lg hover:bg-gray-100 transition-colors duration-200"
>
    <svg xmlns="http://www.w3.org/2000/svg" 
         class="h-5 w-5 bookmark-icon {% if destination.is_bookmarked %}text-yellow-400{% else %}text-gray-400{% endif %}"
         fill="currentColor" 
         viewBox="0 0 24 24" 
         stroke="currentColor">
        <path stroke-linecap="round" 
              stroke-linejoin="round" 
              stroke-width="2" 
              d="M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z" />
    </svg>
</button>

<script>
function toggleBookmark(destinationId, button) {
    // Get the CSRF token from the cookie
    const csrftoken = document.querySelector('[name=csrfmiddlewaretoken]').value;
    
    fetch(`/destination/${destinationId}/bookmark/`, {
        method: 'POST',
        headers: {
            'X-CSRFToken': csrftoken,
            'Content-Type': 'application/json',
            'X-Requested-With': 'XMLHttpRequest'
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.status === 'success') {
            // Get the icon element within the button
            const icon = button.querySelector('.bookmark-icon');
            
            // Toggle the color classes
            if (data.is_bookmarked) {
                icon.classList.remove('text-gray-400');
                icon.classList.add('text-yellow-400');
            } else {
                icon.classList.remove('text-yellow-400');
                icon.classList.add('text-gray-400');
            }
        }
    })
    .catch(error => console.error('Error:', error));
}
</script>